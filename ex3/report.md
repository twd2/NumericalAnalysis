#  实验4 数值积分

## 题目1

###  实验要求

![req1](req1.png)

### 算法描述

TODO

### 程序清单

* `int.cpp`：主要实验代码

### 运行结果

完整输出结果请见`int.txt`。

下述理论积分值为$e - 1 \approx 1.71828182845904510000$。

#### (1) 复合梯形公式以及复合辛普森公式

**复合梯形公式**

余项为$|R_T(f)| = |-\frac{b - a}{12}h^2f''(\eta)|  = \frac{b - a}{12}h^2e^\eta \le \frac{b - a}{12}h^2e^1 = \frac{e}{12n^2}$

令$\frac{e}{12n^2} \le 10^{-6}$，得$n \ge \sqrt{\frac{10^6e}{12}} \approx 475.9$，取$n = 476$

程序输出为

```
  T   = 1.71828246043304600000, diff = 0.00000063197400084782
```

误差为$0.631974 \times 10^{-6}$，与理论值误差真的不超过$10^{-6}$。

**复合辛普森公式**

余项为$|R_S(f)| = |\frac{b - a}{180}(\frac{h}{2})^4f^{(4)}(\eta)|  = \frac{b - a}{180}(\frac{h}{2})^4e^\eta \le \frac{b - a}{180}(\frac{h}{2})^4e^1 = \frac{e}{2880n^4}$

令$\frac{e}{2880n^4} \le 10^{-6}$，得$n \ge (\frac{10^6e}{2880})^{\frac{1}{4}} \approx 5.5$，取$n = 6$

程序输出为

```
  S   = 1.71828228843802040000, diff = 0.00000045997897537306
```

误差为$0.459979 \times 10^{-6}$，与理论值误差真的不超过$10^{-6}$。

#### (2) 龙贝格求积算法

```
0 1.85914091422952250000
1 1.75393109246482530000 1.71886115187659280000
2 1.72722190455751660000 1.71831884192174700000 1.71828268792475720000
3 1.72051859216430180000 1.71828415469989680000 1.71828184221844000000 1.71828182879453030000
  L   = 1.71828182879453030000, diff = 0.00000000033548519518
```

可以看到，$|T_3^{(0)} - T_2^{(1)}| \approx 0.0000000134239 \lt 10^{-6}$时，算法停止。最终结果为$1.71828182879453030000$，与理论值相差$0.00033548519518 \times 10^{-6}$，远远小于$10^{-6}$。

此时仅分了$2^3 = 8$个等份。

## 题目2

### 实验要求

![req2](req2.png)

### 算法描述

TODO

### 程序清单

- `gauss.cpp`：主要实验代码

### 运行结果

输出结果请见`gauss.txt`。

$$f^{(4)}(x) = (\frac{4}{1 + x^2})^{(4)} = \frac{1536x^4}{(1 + x^2)^5} - \frac{1152x^2}{(1 + x^2)^4} + \frac{96}{(1 + x^2)^3}$$

$$\max|f^{(4)}(x)| = 96$$

于是，余项为$|R_G(f)| = |\frac{b - a}{4320}h^4f^{(4)}(\eta)| \le \frac{b - a}{4320}h^4 \times 96 = $

输出结果为：

```

```

TODO

### 体会与展望

本次实验我实现并测试了多种数值积分算法，包括复合梯形公式、复合辛普森公式、龙贝格求积算法以及复合高斯公式。TODO

